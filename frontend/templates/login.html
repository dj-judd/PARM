{% extends "base.html" %}

{% block content %}
  <div class="container">
    <h1>Login</h1>
    <form id="login-form">
      <div>
        <label for="email_address">Email Address:</label>
        <input type="text" id="email_address" name="email_address">
      </div>
      <div>
        <label for="password">Password:</label>
        <input type="password" id="password" name="password">
      </div>
      <div>
        <input type="checkbox" id="rememberMe" name="rememberMe">
        <label for="rememberMe">Remember Me</label>
      </div>
  
      <input type="submit" value="Login">
    </form>
  </div>
  
  <script>
    // JavaScript to handle form submission
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('login-form');
      form.addEventListener('submit', function(event) {
        event.preventDefault();
        const email_address = document.getElementById('email_address').value;
        const password = document.getElementById('password').value;
        fetch('http://localhost:5000/login', {
          method: 'POST',
          headers: {'Content-Type': 'application/x-www-form-urlencoded'},
          body: `email_address=${email_address}&password=${password}`
        }).then(response => {
          if (!response.ok) {
            return response.text().then(text => { throw new Error(text) });
          }
          return response.json();
        }).then(data => {
          // Handle server response here
          const rememberMe = document.getElementById('rememberMe').checked;
          if (rememberMe) {
              document.cookie = `email=${email_address}; path=/`;
              document.cookie = `password=${password}; path=/`;
          }
          alert("Login successful!");  // Show a success message
          window.location.href = "/app";  // Navigate to the next page
        }).catch(error => {
          console.error('Fetch error:', error);
        });
      });
    });
  </script>
  
{% endblock %}
